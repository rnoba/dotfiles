#!/bin/env sh

DISPLAY=:0
XAUTHORITY=$HOME/.Xauthority
VT=${XDG_VTRN:-1}

Xorg $DISPLAY vt$VT -auth $XAUTHORITY &
X_PID=$!

cleanup() {
	kill $X_PID 2> /dev/null
	wait $X_PID 2> /dev/null
}
trap cleanup EXIT

sleep 1

export DISPLAY
export XAUTHORITY

export XDG_CURRENT_DESKTOP=i3
export XDG_SESSION_TYPE=x11
export DESKTOP_SESSION=i3

[ -f $HOME/.Xresources ] && xrdb -merge $HOME/.Xresources
[ -f $HOME/.Xmodmap ]		 && xmodmap $HOME/.Xmodmap

dbus-run-session i3
